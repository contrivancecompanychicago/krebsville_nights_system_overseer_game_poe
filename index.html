<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Krebsville Nights: Unequal Treatment | COSINE MUD</title>
  
  <!-- Tailwind CDN -->
  <script src="https://cdn.tailwindcss.com"></script>
  
  <!-- Lucide Icons CDN -->
  <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
  
  <!-- Custom Styles: CRT effects, glitch, glow -->
  <link rel="stylesheet" href="styles.css">
  
  <style>
    /* Inline fallback styles */
    body {
      background-color: #0a0e27;
      color: #e0e6ff;
      font-family: 'Courier New', monospace;
      overflow: hidden;
    }
    
    .game-container {
      display: flex;
      flex-direction: column;
      min-height: 100vh;
    }
  </style>
</head>
<body class="bg-slate-950">
  <div id="app" class="relative min-h-screen flex flex-col justify-between game-container">
    
    <!-- ============ HUD TOP BAR ============ -->
    <header class="hud-top flex items-center justify-between px-8 py-4 border-b border-pink-600/60 bg-gradient-to-b from-black/80 to-transparent z-20">
      <!-- Left: Game Title -->
      <div class="flex items-center space-x-3">
        <div class="text-xl font-bold tracking-wider">
          <span class="neon-violet">KREBSVILLE</span>
          <span class="text-pink-400 ml-1">NIGHTS</span>
        </div>
        <span class="text-xs text-violet-400 border-l border-violet-600 pl-3">System v1.1.0 | COSINE MUD</span>
      </div>
      
      <!-- Right: Game Stats -->
      <div class="flex items-center space-x-8 text-sm">
        <!-- Time Tokens -->
        <div class="hud-stat flex items-center space-x-1">
          <i data-lucide="hourglass" class="w-4 h-4 neon-violet"></i>
          <span class="text-slate-300">Tokens:</span>
          <span id="hud-timeTokens" class="neon-violet font-bold">37</span>
        </div>
        
        <!-- Credits -->
        <div class="hud-stat flex items-center space-x-1">
          <i data-lucide="coins" class="w-4 h-4 neon-pink"></i>
          <span class="text-slate-300">Credits:</span>
          <span id="hud-credits" class="neon-pink font-bold">3480</span>
        </div>
        
        <!-- Hazard Level -->
        <div class="hud-stat flex items-center space-x-1">
          <i data-lucide="alert-triangle" class="w-4 h-4 text-red-400"></i>
          <span class="text-slate-300">Hazard:</span>
          <span id="hud-hazardLevel" class="font-bold text-red-400">4</span>
          <span class="text-slate-500">/5</span>
        </div>
        
        <!-- Current Zone -->
        <div class="hud-stat flex items-center space-x-1 border-l border-violet-700 pl-4">
          <i data-lucide="map-pin" class="w-4 h-4 text-violet-400"></i>
          <span id="hud-currentZone" class="text-violet-300 font-mono text-xs">Oncology_Research</span>
        </div>
      </div>
    </header>

    <!-- ============ MAIN GAME AREA ============ -->
    <main class="game-main flex-grow flex flex-col items-center justify-start py-12 px-6 overflow-y-auto">
      
      <!-- Zone/Room Header -->
      <section class="w-full max-w-3xl mb-10">
        <h1 id="zone-title" class="text-4xl font-bold neon-violet tracking-widest uppercase text-center mb-3">
          Genetic Sequencing Hub
        </h1>
        <div class="h-1 w-24 mx-auto bg-gradient-to-r from-violet-600 to-pink-600 rounded mb-6"></div>
      </section>

      <!-- Zone/Room Description -->
      <section class="w-full max-w-3xl mb-8">
        <p id="zone-desc" class="text-slate-200 text-center leading-relaxed text-base">
          Hazy with smoke and the ozone reek of subterranean machinery. Violet neon flickers behind damaged CRT screens, casting ghostly shadows across banks of genetic sequencing equipment. The hum reverberates through your bones. Dr. Grant crouches in the narrow vents, scanning for a safe path forward. The air tastes of copper and chemical vapor.
        </p>
      </section>

      <!-- Environmental Status Indicators -->
      <section class="w-full max-w-3xl mb-10 grid grid-cols-1 md:grid-cols-3 gap-4">
        <div class="border border-violet-600/50 bg-violet-900/10 p-4 rounded text-center">
          <p class="text-xs text-violet-400 uppercase tracking-wider mb-1">Light Level</p>
          <p id="env-light" class="text-lg font-bold neon-violet">HAZY</p>
        </div>
        <div class="border border-red-600/50 bg-red-900/10 p-4 rounded text-center">
          <p class="text-xs text-red-400 uppercase tracking-wider mb-1">Environmental</p>
          <p id="env-hazard" class="text-lg font-bold text-red-400">SMOKE_INHALATION</p>
        </div>
        <div class="border border-pink-600/50 bg-pink-900/10 p-4 rounded text-center">
          <p class="text-xs text-pink-400 uppercase tracking-wider mb-1">Proximity Alert</p>
          <p id="env-proximity" class="text-lg font-bold neon-pink">CLEAR</p>
        </div>
      </section>

      <!-- NPCs/Companions -->
      <section class="w-full max-w-3xl mb-10">
        <h2 class="text-xs font-bold uppercase tracking-widest text-violet-400 mb-3">ZONE OCCUPANTS</h2>
        <div id="npc-list" class="space-y-2">
          <div class="border border-slate-600 bg-black/40 p-4 rounded flex justify-between items-center">
            <div>
              <p class="font-bold text-pink-300">Dr. Kovacs</p>
              <p class="text-xs text-slate-400">Rogue Researcher â€¢ Seeking Hazmat Repairs</p>
            </div>
            <span class="text-xs bg-green-900/50 text-green-400 px-2 py-1 rounded">PRESENT</span>
          </div>
        </div>
      </section>

      <!-- Dynamic Action Buttons -->
      <section id="action-area" class="w-full max-w-2xl flex flex-col items-center space-y-3 mb-10">
        <h2 class="text-xs font-bold uppercase tracking-widest text-violet-400 mb-2">AVAILABLE ACTIONS</h2>
        <div class="grid grid-cols-2 gap-3 w-full">
          <button class="action-button" onclick="handleAction('inspect')">
            <i data-lucide="eye" class="w-4 h-4"></i> Inspect Surroundings
          </button>
          <button class="action-button" onclick="handleAction('commune')">
            <i data-lucide="user" class="w-4 h-4"></i> Commune: Dr. Kovacs
          </button>
          <button class="action-button" onclick="handleAction('contrive')">
            <i data-lucide="wrench" class="w-4 h-4"></i> Contrive Item
          </button>
          <button class="action-button" onclick="handleAction('hazard_check')">
            <i data-lucide="zap" class="w-4 h-4"></i> Hazard Check (DC13)
          </button>
        </div>
      </section>

      <!-- Inventory Preview -->
      <section class="w-full max-w-2xl mb-10">
        <h2 class="text-xs font-bold uppercase tracking-widest text-violet-400 mb-2">INVENTORY</h2>
        <div id="inventory-list" class="grid grid-cols-2 gap-2">
          <div class="bg-slate-800/50 border border-slate-700 p-3 rounded text-xs">
            <p class="font-bold text-pink-300">Faulty Sequencer Part</p>
            <p class="text-slate-500">qty: 1</p>
          </div>
          <div class="bg-slate-800/50 border border-slate-700 p-3 rounded text-xs">
            <p class="font-bold text-violet-300">Salvaged Circuit Board</p>
            <p class="text-slate-500">qty: 2</p>
          </div>
        </div>
      </section>

    </main>

    <!-- ============ HUD BOTTOM (CONSOLE) ============ -->
    <footer class="hud-bottom border-t border-violet-700 bg-gradient-to-t from-black to-black/60 z-20">
      <!-- Console Output -->
      <div id="console" class="console-text text-xs overflow-y-auto mb-3" style="max-height: 120px; min-height: 60px;">
        <div class="console-message">
          <span class="text-pink-400">[SYSTEM]</span> <span class="text-slate-300">Welcome to the Genetic Sequencing Hub, Dr. Grant. The vents hum with danger. What will you do?</span>
        </div>
        <div class="console-message mt-1">
          <span class="text-violet-400">[ENV_SCAN]</span> <span class="text-slate-300">Hazard baseline: 4/5. Smoke inhalation risk. Equipment integrity: 60%.</span>
        </div>
      </div>
      
      <!-- Console Input -->
      <form id="console-input-form" class="flex gap-2" onsubmit="handleConsoleInput(event)">
        <input 
          type="text" 
          id="console-input" 
          placeholder="Type command (e.g., examine equipment, move south, contrive)" 
          autocomplete="off"
          class="flex-grow bg-black/60 border border-violet-700 px-4 py-2 text-pink-100 rounded-l focus:outline-none focus:ring focus:ring-violet-600 focus:border-transparent text-xs" 
        />
        <button type="submit" class="action-button rounded-r border-0">
          <i data-lucide="send" class="w-4 h-4"></i> Send
        </button>
      </form>
    </footer>

    <!-- ============ CRT SCANLINE OVERLAY ============ -->
    <div class="pointer-events-none fixed inset-0 z-50" style="mix-blend-mode: screen; opacity: 0.03;">
      <div id="scanlines" class="absolute w-full h-full" style="
        background: repeating-linear-gradient(
          0deg,
          rgba(0, 0, 0, 0.15),
          rgba(0, 0, 0, 0.15) 1px,
          transparent 1px,
          transparent 2px
        );
        pointer-events: none;
      "></div>
    </div>

  </div>

  <!-- ============ SCRIPTS ============ -->
  <script>
    // Initialize Lucide icons when DOM is ready
    document.addEventListener('DOMContentLoaded', () => {
      lucide.createIcons();
      console.log('[INIT] Krebsville Nights COSINE MUD initialized.');
    });

    // Placeholder action handler
    function handleAction(action) {
      console.log('Action triggered:', action);
      addConsoleMessage(`[ACTION] Executing: ${action.toUpperCase()}`);
    }

    // Placeholder console input handler
    function handleConsoleInput(event) {
      event.preventDefault();
      const input = document.getElementById('console-input');
      const command = input.value.trim();
      
      if (!command) return;
      
      addConsoleMessage(`[PLAYER] ${command}`);
      input.value = '';
      
      // Process command via engine.js
      if (window.processCommand) {
        window.processCommand(command);
      }
    }

    // Helper function to add message to console
    function addConsoleMessage(message, type = 'system') {
      const console_el = document.getElementById('console');
      const msg_div = document.createElement('div');
      msg_div.className = 'console-message mt-1';
      msg_div.innerHTML = `<span class="text-slate-300">${message}</span>`;
      console_el.appendChild(msg_div);
      console_el.scrollTop = console_el.scrollHeight;
    }
  </script>

  <!-- Load main game engine -->
  <script src="engine.js" defer></script>

</body>
</html>